---
import ProductLayout from "../../layouts/ProductLayout.astro";
import { type StrapiResponse } from "../../types/interface/strapi-response";
import { type Product } from "../../types/interface/product";
import { Category } from "../../types/enums/Category";
import { getBaseUrl } from "../../utils/getBaseURL";

export async function getStaticPaths() {
  const baseUrl = getBaseUrl();
  const res = await fetch(
    `${baseUrl}/api/products?filters[category][name][$eq]=headphones&populate=*&sort=new:desc`
  );
  const { data }: StrapiResponse<Product> = await res.json();

  return data.map((product: Product) => {
    return {
      params: { slug: product.slug },
      props: { product },
    };
  });
}

interface Props {
  product: Product;
}

const { product } = Astro.props;
---

<ProductLayout product={product} category={Category.HEADPHONES} />
